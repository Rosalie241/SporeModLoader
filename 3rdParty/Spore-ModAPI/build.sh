#!/usr/bin/env bash
set -e
SOURCES=(
	"Spore ModAPI/SourceCode/Allocator.cpp"
	"Spore ModAPI/SourceCode/Anim/Animations.cpp"
	"Spore ModAPI/SourceCode/App/App.cpp"
	"Spore ModAPI/SourceCode/App/Cameras.cpp"
	"Spore ModAPI/SourceCode/App/CheatManager.cpp"
	"Spore ModAPI/SourceCode/App/GameModes.cpp"
	"Spore ModAPI/SourceCode/App/LocaleManager.cpp"
	"Spore ModAPI/SourceCode/App/Messages.cpp"
	"Spore ModAPI/SourceCode/App/PropManager.cpp"
	"Spore ModAPI/SourceCode/App/PropertyList.cpp"
	"Spore ModAPI/SourceCode/App/ScenarioMode.cpp"
	"Spore ModAPI/SourceCode/App/Viewer.cpp"
	"Spore ModAPI/SourceCode/Audio/AudioSystem.cpp"
	"Spore ModAPI/SourceCode/Clock.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Image.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesAnim.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesUTFWin.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesApp.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesArgScript.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesAudio.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesEditors.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesGalaxyGameEntry.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesGraphics.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesIO.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesMisc.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesPalettes.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesPollinator.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesRenderWare.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesResource.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesSimulator.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesSkinner.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesSporepedia.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesSwarm.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesTerrain.cpp"
	"Spore ModAPI/SourceCode/DLL/AddressesUI.cpp"
	"Spore ModAPI/SourceCode/DLL/Application.cpp"
	"Spore ModAPI/SourceCode/DLL/DllModAPI.cpp"
	"Spore ModAPI/SourceCode/DLL/SpaceToolIconOverride.cpp"
	"Spore ModAPI/SourceCode/DLL/TextureOverride.cpp"
	"Spore ModAPI/SourceCode/DLL/dllmain.cpp"
	"Spore ModAPI/SourceCode/DLL/stdafx.cpp"
	"Spore ModAPI/SourceCode/Debugging.cpp"
	"Spore ModAPI/SourceCode/ArgScript/ArgScript.cpp"
	"Spore ModAPI/SourceCode/ArgScript/ClassManager.cpp"
	"Spore ModAPI/SourceCode/EASTL/EAMemory.cpp"
	"Spore ModAPI/SourceCode/EASTL/EASprintf.cpp"
	"Spore ModAPI/SourceCode/EASTL/allocator_eastl.cpp"
	"Spore ModAPI/SourceCode/EASTL/assert.cpp"
	"Spore ModAPI/SourceCode/EASTL/fixed_pool.cpp"
	"Spore ModAPI/SourceCode/EASTL/hashtable.cpp"
	"Spore ModAPI/SourceCode/EASTL/intrusive_list.cpp"
	"Spore ModAPI/SourceCode/EASTL/numeric_limits.cpp"
	"Spore ModAPI/SourceCode/EASTL/red_black_tree.cpp"
	"Spore ModAPI/SourceCode/EASTL/string.cpp"
	"Spore ModAPI/SourceCode/EASTL/thread_support.cpp"
	"Spore ModAPI/SourceCode/Editors/BakeManager.cpp"
	"Spore ModAPI/SourceCode/Editors/Colorpickers.cpp"
	"Spore ModAPI/SourceCode/Editors/Editor.cpp"
	"Spore ModAPI/SourceCode/Editors/EditorCamera.cpp"
	"Spore ModAPI/SourceCode/Editors/EditorPalettes.cpp"
	"Spore ModAPI/SourceCode/Editors/EditorPlayMode.cpp"
	"Spore ModAPI/SourceCode/Editors/EditorRequest.cpp"
	"Spore ModAPI/SourceCode/Editors/PaletteItemFrame.cpp"
	"Spore ModAPI/SourceCode/Editors/SpeciesManager.cpp"
	"Spore ModAPI/SourceCode/FixedPoolAllocator.cpp"
	"Spore ModAPI/SourceCode/Graphics/GeneratedMesh.cpp"
	"Spore ModAPI/SourceCode/Graphics/GraphicsManager.cpp"
	"Spore ModAPI/SourceCode/Graphics/Lighting.cpp"
	"Spore ModAPI/SourceCode/Graphics/Materials.cpp"
	"Spore ModAPI/SourceCode/Graphics/Models.cpp"
	"Spore ModAPI/SourceCode/Graphics/RenderTargets.cpp"
	"Spore ModAPI/SourceCode/Graphics/Rendering.cpp"
	"Spore ModAPI/SourceCode/Graphics/Shadows.cpp"
	"Spore ModAPI/SourceCode/Graphics/Textures.cpp"
	"Spore ModAPI/SourceCode/Graphics/ThumbnailManager.cpp"
	"Spore ModAPI/SourceCode/IO/IODefinitions.cpp"
	"Spore ModAPI/SourceCode/IO/ResourceManager.cpp"
	"Spore ModAPI/SourceCode/IO/StreamDefinitions.cpp"
	"Spore ModAPI/SourceCode/IO/ThreadedObject.cpp"
	"Spore ModAPI/SourceCode/IO/XML.cpp"
	"Spore ModAPI/SourceCode/LocalizedString.cpp"
	"Spore ModAPI/SourceCode/Math.cpp"
	"Spore ModAPI/SourceCode/Mutex.cpp"
	"Spore ModAPI/SourceCode/Object.cpp"
	"Spore ModAPI/SourceCode/Pollinator/Pollinator.cpp"
	"Spore ModAPI/SourceCode/RenderWare/RWBuffers.cpp"
	"Spore ModAPI/SourceCode/RenderWare/RWMesh.cpp"
	"Spore ModAPI/SourceCode/RenderWare/RWSkeleton.cpp"
	"Spore ModAPI/SourceCode/RenderWare/Raster.cpp"
	"Spore ModAPI/SourceCode/RenderWare/RenderWare.cpp"
	"Spore ModAPI/SourceCode/ResourceKey.cpp"
	"Spore ModAPI/SourceCode/Simulator/CommManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/CreatureGame.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameBehaviorManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameInputManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameModeManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameNounManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameTimeManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/GameViewManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/MissionManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/PlanetModel.cpp"
	"Spore ModAPI/SourceCode/Simulator/Planets.cpp"
	"Spore ModAPI/SourceCode/Simulator/RelationshipManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/Scenario.cpp"
	"Spore ModAPI/SourceCode/Simulator/Serialization.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorCell.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorClock.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorMessages.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorMisc.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorSpaceGame.cpp"
	"Spore ModAPI/SourceCode/Simulator/SimulatorSystem.cpp"
	"Spore ModAPI/SourceCode/Simulator/SolarSystem.cpp"
	"Spore ModAPI/SourceCode/Simulator/SpaceInventory.cpp"
	"Spore ModAPI/SourceCode/Simulator/SpacePlayerData.cpp"
	"Spore ModAPI/SourceCode/Simulator/StarManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/Terraforming.cpp"
	"Spore ModAPI/SourceCode/Simulator/ToolManager.cpp"
	"Spore ModAPI/SourceCode/Simulator/Tools.cpp"
	"Spore ModAPI/SourceCode/Simulator/UIEventLog.cpp"
	"Spore ModAPI/SourceCode/Simulator/cCity.cpp"
	"Spore ModAPI/SourceCode/Simulator/cCreatureAbility.cpp"
	"Spore ModAPI/SourceCode/Simulator/cCreatureAnimal.cpp"
	"Spore ModAPI/SourceCode/Simulator/cCultureSet.cpp"
	"Spore ModAPI/SourceCode/Simulator/cEmpire.cpp"
	"Spore ModAPI/SourceCode/Simulator/cGameData.cpp"
	"Spore ModAPI/SourceCode/Simulator/cGameDataUFO.cpp"
	"Spore ModAPI/SourceCode/Simulator/cGameTerrainCursor.cpp"
	"Spore ModAPI/SourceCode/Simulator/cSimulatorPlayerUFO.cpp"
	"Spore ModAPI/SourceCode/Simulator/cSpatialObject.cpp"
	"Spore ModAPI/SourceCode/Simulator/cStarRecord.cpp"
	"Spore ModAPI/SourceCode/Simulator/cTribe.cpp"
	"Spore ModAPI/SourceCode/Simulator/cVehicle.cpp"
	"Spore ModAPI/SourceCode/Skinner.cpp"
	"Spore ModAPI/SourceCode/Sporepedia/AssetData.cpp"
	"Spore ModAPI/SourceCode/Sporepedia/Assetbrowser.cpp"
	"Spore ModAPI/SourceCode/Sporepedia/Shopper.cpp"
	"Spore ModAPI/SourceCode/Swarm/Effects.cpp"
	"Spore ModAPI/SourceCode/Swarm/SwarmManager.cpp"
	"Spore ModAPI/SourceCode/Terrain/Terrain.cpp"
	"Spore ModAPI/SourceCode/UI/HintManager.cpp"
	"Spore ModAPI/SourceCode/UI/LayerManager.cpp"
	"Spore ModAPI/SourceCode/UI/ScrollFrame.cpp"
	"Spore ModAPI/SourceCode/UI/SpaceGameUI.cpp"
	"Spore ModAPI/SourceCode/UI/UI.cpp"
	"Spore ModAPI/SourceCode/UI/cSPUITextZoom.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Cursors.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Defaults.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Drawables.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Events.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Graphics2D.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Interactives.cpp"
	"Spore ModAPI/SourceCode/UTFWin/LayoutElements.cpp"
	"Spore ModAPI/SourceCode/UTFWin/OutlineFormat.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Tooltips.cpp"
	"Spore ModAPI/SourceCode/UTFWin/UIEffects.cpp"
	"Spore ModAPI/SourceCode/UTFWin/UILayout.cpp"
	"Spore ModAPI/SourceCode/UTFWin/UISerialization.cpp"
	"Spore ModAPI/SourceCode/UTFWin/UTFWinAllocator.cpp"
	"Spore ModAPI/SourceCode/UTFWin/Window.cpp"
	"Spore ModAPI/SourceCode/UTFWin/WindowManager.cpp"
	"../Detours/src/detours.cpp"
	"../Detours/src/modules.cpp"  
	"../Detours/src/disasm.cpp" 
	"../Detours/src/image.cpp"   
	"../Detours/src/creatwth.cpp"
	"../Detours/src/disolx86.cpp"
)

OBJECT_FILES=()

for source in "${SOURCES[@]}"
do
	echo "CXX $source"
	i686-w64-mingw32-g++ -c "$source" -o "${source}.o" \
		-DEXECUTABLE_TYPE=2 -DMODAPI_DLL_EXPORT=1 -DSDK_BUILD_VER=320 \
		-I"./Spore ModAPI/" \
		-I"../Detours/src" \
		-I"./EASTL-3.02.01/include/" \
		-I"./EASTL-3.02.01/test/packages/EAStdC/include" \
		-I"./EASTL-3.02.01/test/packages/EAAssert/include" \
		-I"./EASTL-3.02.01/test/packages/EABase/include/Common/" \
		-Wno-attributes -Wp,-w -O0
	OBJECT_FILES+=("${source}.o")
done

#i686-w64-mingw32-windres -v "Spore ModAPI/SourceCode/DLL/VersionInfo.rc" \
#	-DEXECUTABLE_TYPE=10 -DSDK_BUILD_VER=310

#OBJECT_FILES+=("Spore ModAPI/SourceCode/DLL/VersionInfo.rc.o" )

echo "LD  SporeModAPI.dll"
i686-w64-mingw32-g++ "${OBJECT_FILES[@]}" SporeModAPI.def -static -shared -o SporeModAPI.dll